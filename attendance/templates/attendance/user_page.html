{% extends 'attendance/base.html' %}
{% load static %}

{% block header_text %}
User's profile page
{% endblock %}


	{% block content-left %}
	<div class="bs-callout bs-callout-info">
		<h3><img src="https://media.giphy.com/media/LHZyixOnHwDDy/giphy.gif" height="50" /> Users At Work ({{at_work_users | length}}):</h3>

		{% for user in at_work_users %}
			<p>{{user.username}}</p>
		{%endfor %}
	</div>
	<div class="bs-callout bs-callout-info">
		{% if user.username == "jaroslav.malec" %}
		<h3><img src="https://media.licdn.com/mpr/mpr/shrinknp_200_200/AAEAAQAAAAAAAAdPAAAAJDFjMWYyYmRkLTE3MjktNDZiOS04YTAzLWM3ODM2MGZlMDBjOA.jpg" height="" /> Users On Break ({{on_break_users | length}}):</h3>
		{% else %}
		<h3><img src="https://media.giphy.com/media/GqZi964Bo9f0I/giphy.gif" height="70" /> Users On Break ({{on_break_users | length}}):</h3>
		{% endif %}
		{% for user in on_break_users%}
			<p>{{user.username}}</p>
		{%endfor %}
	</div>
	<div class="bs-callout bs-callout-info">
		<h3><img src="https://media.giphy.com/media/l46C7ZlmzYkclCvwA/giphy.gif" height="40" /> Users On Trip ({{on_trip_users | length}}):</h3>
		{% for user in on_trip_users%}
			<p>{{user.username}}</p>
		{%endfor %}
	</div>

	{% endblock %}
	{% block content %}
	
	<div class="">
		<br />
		<div class="panel panel-body">
			<div class="col-md-3">
				<img src="{% static "user_img/default.gif" %}" alt="Users profile image" class="img-circle img-responsive userImage" style="width:100px"/>
			</div>
			<div class="col-md-9">
				<h4>{{user.first_name}} {{user.last_name}} <span class="label label-{% if user.is_superuser %}primary">Admin{% else %}warning">User{% endif %}</span></h4>
				<table class="table table-responsive">
					<tr>
						<td>Name</td>
						<td>{{user.first_name}}</td>
					</tr>
					<tr>
						<td>Surname</td>
						<td>{{user.last_name}}</td>
					</tr>
					<tr>
						<td>Email</td>
						<td>{{user.email}}</td>
					</tr>
					<tr>
						<td>Login</td>
						<td>{{user.username}}</td>
					</tr>
				</table>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="bs-callout bs-callout-info col-md-4">
			<h3>This Month:</h3>
			<p class="">Total Hours: {{ hours_total_this_month|floatformat:2}}</p>
			<p class="">Unassigned Hours: {{ hours_unassigned_this_month | floatformat:2}}</p>
			<p class="">Assigned Hours: {{ hours_assigned_this_month | floatformat:2}}</p>
			<p class="">Not Work Hours: {{ hours_not_work_this_month| floatformat:2}}</p>
			<p class="">Sessions this month: {{session_list | length}}</p>
			{% if not hours_unassigned_this_month %}
				<p class="text-success"><span class="glyphicon glyphicon-thumbs-up"></span> You have all hours assigned to projects.</p>
			{% else  %}
				<p class="text-danger"><span class="glyphicon glyphicon-thumbs-down"></span> 
					You have {{ hours_unassigned_this_month | floatformat:2}} unassigned hours. You have to assign all hours to projects until end of month.
				</p>
			{% endif %}
		</div>
		<div class="bs-callout bs-callout-info col-md-4">
			<h3>Last Month:</h3>
			<p class="">Total Hours: {{ hours_total_last_month|floatformat:2}}</p>
			<p class="">Unassigned Hours: {{ hours_unassigned_last_month | floatformat:2}}</p>
			<p class="">Assigned Hours: {{ hours_assigned_last_month | floatformat:2}}</p>
			<p class="">Not Work Hours: {{ hours_not_work_last_month| floatformat:2}}</p>
			{% if not hours_unassigned_last_month %}
				<p class="text-success"><span class="glyphicon glyphicon-thumbs-up"></span> You have all hours assigned to projects. Your attendance can be calculated by administrator.</p>
			{% else  %}
				<p class="text-danger"><span class="glyphicon glyphicon-thumbs-down"></span> 
					You have {{ hours_unassigned_last_month | floatformat:2}} unassigned hours. You have to assign all hours to projects in Sessions page.
					Only assigned hours will be counted as attendance.
				</p>
			{% endif %}

		</div>
	</div>
	<p class="">Last Swipe:&nbsp  
		<img src="
				{% if last_swipe.swipe_type == 'IN' %}{% static "img/incom.svg" %}
				{% elif last_swipe.swipe_type == 'OUT' %}{% static "img/outgo.svg" %}
				{% elif last_swipe.swipe_type == 'OBR' %}{% static "img/break.svg" %}
				{% elif last_swipe.swipe_type == 'FBR' %}{% static "img/break_ret.svg" %}
				{% elif last_swipe.swipe_type == 'OTR' %}{% static "img/trip.svg" %}
				{% elif last_swipe.swipe_type == 'FTR' %}{% static "img/trip_ret.svg" %}
				{% endif %}
			" />
		&nbsp{{last_swipe.datetime | date:'D d.m.Y H:i:s'}}
	</p>
	<form action="{% url 'user' username=user.username %}" method="post">
		{% csrf_token %}
		{% for swipe_type in next_swipes %}
				{% if swipe_type == "IN" %}
				<button type="submit" class="btn btn-primary" value="Incoming" name = "{{swipe_type}}" />
					<img src="{% static "img/incom.svg" %}">
					</br>
					Incoming
				</button>
				{% endif %}
				{% if swipe_type == "OUT" %}
					<button type="submit" class="btn btn-primary" value="Outgoing" name = "{{swipe_type}}" />
						<img src="{% static "img/outgo.svg" %}">
						</br>
						Outgoing
					</button>
				{% endif %}
				{% if swipe_type == "OBR" %}
					<button type="submit" class="btn btn-primary" value="Break" name = "{{swipe_type}}" />
						<img src="{% static "img/break.svg" %}">
						</br>
						Break
					</button>
				{% endif %}
				{% if swipe_type == "FBR" %}
					<button type="submit" class="btn btn-primary" value="Break Return" name = "{{swipe_type}}" />
						<img src="{% static "img/break_ret.svg" %}">
						</br>
						Break Return
					</button>
				{% endif %}
				{% if swipe_type == "OTR" %}
					<button type="submit" class="btn btn-primary" value="Trip" name = "{{swipe_type}}" />
						<img src="{% static "img/trip.svg" %}">
						</br>
						Work Trip
					</button>
				{% endif %}
				{% if swipe_type == "FTR" %}
					<button type="submit" class="btn btn-primary" value="Trip Return" name = "{{swipe_type}}" />
						<img src="{% static "img/trip_ret.svg" %}">
						</br>
						Trip Return
					</button>
				{% endif %}
		{%endfor %}

	</form>

	{% endblock %}

