{% extends 'attendance/base.html' %}
{% load static %}

{% block scripts %}
<!--Moment.js: used for timepicker-->
<script src="{% static 'moment/moment.js'%}"></script>
<!--bootstrap-DateTimePicker-->
<script type="text/javascript" language="javascript" src="{% static 'eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css' %}">
{% endblock %}

{% block title %}Holiday Assignment{% endblock %}
{% block aside %}

{% endblock %}
{% block content %}
<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
  <div class="modal-dialog" role="document">
    <div class="modal-content modal-primary">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">
        	Holiday assignment - {{user.username}}<span class="modal-icon fa fa-info pull-right"></span>
        </h4>
      </div>
      <div class="modal-body">
				<table class="table table-primary-inverse">
					<thead>
					<tr class="upper">
					  <th class="col-md-2">Parameter</th>
					  <th class="col-md-4">Value</th>
					</tr>
					</thead>
					<tbody>
						<tr>
							<td data-field="key" class="key">Reason</td>
							<td><input type='text' name='reason' id='id_reason' class="form-control" /></td>
						</tr>	
							<tr>
							    <td data-field="key" class="key">Date since:</td>
							    <form method='POST' action=''>{% csrf_token %}
							    <td class="col-md-10">
									<div>
										<div class="form-group">
											<div class='input-group' id='datetimepicker1'>
												<input type='text' name='date_since' id='id_date_since' class="form-control" />
												 <div class="input-group-addon" data-toggle="tooltip" title="Open Date Picker"><i class="fa fa-clock-o"></i></div>
											</div>
										</div>
									</div>
								</td>
							</tr>
							<tr>
							    <td data-field="key" class="key">Date To:</td>
							    <td class="col-md-10">
									<div>
										<div class="form-group">
											<div class='input-group' id='datetimepicker2'>
												<input type='text'  name='date_to' id='date_to' class="form-control"/>
												 <div class="input-group-addon" data-toggle="tooltip" title="Open Date Picker"><i class="fa fa-clock-o"></i></div>
											</div>
										</div>
									</div>
								</td>
							</tr>
						<tr>
							<td>Hours</td>
							<td><input type="text" name='hours_spend' id='hours_spend'/></td>
						</tr>
					</tbody>
				</table>
				{{form.errors}}
				<div class="col-md-3">
				</div>

      </div><!--/modal body-->
      <div class="modal-footer">
      <div class="row">
      	<div class="col-md-3">
      		<a class="btn btn-danger" href="{% url 'user' user.username %}"><i class="fa fa-arrow-left"></i> Back to Dashboard</a>
      	</div>
      	<div class="col-md-4 col-md-offset-5">
      		<button id="submit" type='submit' class="btn btn-primary" value='Send request'>Send Request</button>
      	</div>
      	</form>
      </div>
      </div>
    </div><!--/modal-->
  </div>
</div>

<script type="text/javascript">
 $(document).ready(function(){
    $('#datetimepicker1').datetimepicker({
        viewMode: 'days',
        format: 'DD-MM-YYYY',
    }), 
     
    $('#datetimepicker2').datetimepicker({
        viewMode: 'days',
        format: 'DD-MM-YYYY',
    });
    
    $('#datetimepicker2').on("dp.change", function (e){
		TimeDifference();
		});  
		     
	function TimeDifference(){
		var start = $('#datetimepicker1').data("DateTimePicker").date();
		var end = $('#datetimepicker2').data("DateTimePicker").date();
		var timeDiff = 0;
		timeDiff = (end - start);
		var dateDiff = Math.floor(timeDiff / (60 * 60 * 1000));
		$('#id_hours_spend').val(dateDiff);                                   //problem when correcting a second form and not correwcting the first
		}
		     
    setTimeout(function(){ //set timeout for modal to be shown -like delay
        $('#myModal').modal('show');
      }, 1000);
  });
    /*Add class to see fontawesomes in swipe infos*/
</script>
{% endblock %}
